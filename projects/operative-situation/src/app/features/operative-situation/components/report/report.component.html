<div class="container-fluid h-100">
  <div class="row h-100" *ngIf="!(selectedReport$ | async)">
    <div class="no-report-placeholder col-12">
      Отчет об оперативной обстановке отсутствует
      <button mat-stroked-button
              class="mt-3"
              *ngIf="(selectedDivision$ | async) && (selectedDivision$ | async)?.isReportsAllowed"
              (click)="openAddReportDialog()">
        Добавить отчет
      </button>
    </div>
  </div>

  <div class="row pt-4 pb-4" *ngIf="selectedReport$ | async">
    <div class="col-12">
      <div class="row">
        <div class="col-12">
          <div class="row">
            <div class="col-auto">
              <span class="row-caption">Оборудование 35-150 кВ</span>
            </div>
          </div>

          <div class="row">
            <div class="col-12">

              <!--
              <div class="panel mat-elevation-z1 mb-3 justify-content-between">
                <div class="d-flex flex-row">
                  <div class="panel-group">
                  <div class="group-label">
                    <span class="label">Отключенное оборудование<br>по сети 35-150 кВ</span>
                  </div>
                  <div class="panel-indicators">
                    <div class="panel-indicator">
                      <span class="label">ЛЭП 110-150 кВ, шт</span>
                      <span class="value">1</span>
                    </div>
                    <div class="panel-indicator">
                      <span class="label">ЛЭП 110-150 кВ, шт</span>
                      <span class="value">2</span>
                    </div>
                    <div class="panel-indicator">
                      <span class="label">ПС 110 -150 кВ, шт</span>
                      <span class="value">3</span>
                    </div>
                    <div class="panel-indicator">
                      <span class="label">ПС 35 кВ, шт</span>
                      <span class="value">4</span>
                    </div>
                  </div>
                </div>
                  <div class="panel-group connected">
                    <div class="group-label">
                      <span class="label">Последствия<br>для потребителей</span>
                    </div>
                    <div class="panel-indicators">
                      <div class="panel-indicator">
                        <span class="label">ЛЭП 110-150 кВ, шт</span>
                        <span class="value">1</span>
                      </div>
                      <div class="panel-indicator">
                        <span class="label">ЛЭП 110-150 кВ, шт</span>
                        <span class="value">2</span>
                      </div>
                      <div class="panel-indicator">
                        <span class="label">ПС 110 -150 кВ, шт</span>
                        <span class="value">3</span>
                      </div>
                      <div class="panel-indicator">
                        <span class="label">ПС 35 кВ, шт</span>
                        <span class="value">4</span>
                      </div>
                    </div>
                  </div>
                </div>

                <div class="d-flex flex-row justify-content-end">
                  <div class="panel-group">
                    <div class="group-label">
                      <span class="label">Распред. сеть</span>
                    </div>
                    <div class="panel-indicators">
                      <div class="panel-indicator">
                        <span class="label">ЛЭП 110-150 кВ, шт</span>
                        <span class="value">1</span>
                      </div>
                      <div class="panel-indicator">
                        <span class="label">ЛЭП 110-150 кВ, шт</span>
                        <span class="value">2</span>
                      </div>
                    </div>
                  </div>
                  <div class="panel-group connected">
                    <div class="group-label">
                      <span class="label">Последствия для потребителей</span>
                    </div>
                    <div class="panel-indicators">
                      <div class="panel-indicator">
                        <span class="label">ЛЭП 110-150 кВ, шт</span>
                        <span class="value">1</span>
                      </div>
                      <div class="panel-indicator">
                        <span class="label">ЛЭП 110-150 кВ, шт</span>
                        <span class="value">2</span>
                      </div>
                      <div class="panel-indicator">
                        <span class="label">ПС 110 -150 кВ, шт</span>
                        <span class="value">3</span>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              -->


              <table class="d-flex operative-situation-reports w-100 mat-elevation-z1">
                <tr>
                  <th colspan="4" scope="colgroup" class="top border-right" style="border-color: #E0E0E0 !important;">Отключенное оборудование по сети 35-150 кВ</th>
                  <th colspan="4" scope="colgroup" class="top border-right">Последствия для потребителей по сети 35-150 кВ</th>
                  <th colspan="2" scope="colgroup" class="top border-right">Распределительная сеть</th>
                  <th colspan="3" scope="colgroup" class="top border-right">Последствия для потребителей по распределительной сети</th>
                  <th colspan="4" scope="colgroup" class="top">Последствия для потребителей суммарно по основной и распределительной сети</th>
                </tr>
                <tr>
                  <th scope="col" class="font-weight-normal border-right">ЛЭП 110-150 кВ, шт</th>
                  <th scope="col" class="font-weight-normal border-right">ЛЭП 35 кВ, шт.</th>
                  <th scope="col" class="font-weight-normal border-right">ПС 110 -150 кВ, шт</th>
                  <th scope="col" class="font-weight-normal border-right">ПС 35 кВ, шт</th>

                  <th scope="col" class="font-weight-normal border-right">ТП 6-20 кВ, шт</th>
                  <th scope="col" class="font-weight-normal border-right">Население, чел</th>
                  <th scope="col" class="font-weight-normal border-right">Нагрузка, МВт</th>
                  <th scope="col" class="font-weight-normal border-right">СЗО, шт</th>

                  <th scope="col" class="font-weight-normal border-right">ЛЭП 6-20 кВ, шт</th>
                  <th scope="col" class="font-weight-normal border-right">ТП 6-20 кВ, шт</th>

                  <th scope="col" class="font-weight-normal border-right">Население, чел</th>
                  <th scope="col" class="font-weight-normal border-right">Нагрузка, МВт</th>
                  <th scope="col" class="font-weight-normal border-right">СЗО, шт</th>

                  <th scope="col" class="font-weight-normal border-right">ТП 6-20 кВ, шт</th>
                  <th scope="col" class="font-weight-normal border-right">Население, чел</th>
                  <th scope="col" class="font-weight-normal border-right">Нагрузка, МВт</th>
                  <th scope="col" class="font-weight-normal">СЗО, шт</th>
                </tr>
                <tr class="content">
                  <td class="border-right">{{(selectedReport$ | async)?.equipment_35_150.lep_110_150}}</td>
                  <td class="border-right">{{(selectedReport$ | async)?.equipment_35_150.lep_35}}</td>
                  <td class="border-right">{{(selectedReport$ | async)?.equipment_35_150.ps_110_150}}</td>
                  <td class="border-right">{{(selectedReport$ | async)?.equipment_35_150.ps_35}}</td>

                  <td class="border-right">{{(selectedReport$ | async)?.equipment_35_150.effect.tp_6_20}}</td>
                  <td class="border-right">{{(selectedReport$ | async)?.equipment_35_150.effect.population}}</td>
                  <td class="border-right">{{(selectedReport$ | async)?.equipment_35_150.effect.power}}</td>
                  <td class="border-right">{{(selectedReport$ | async)?.equipment_35_150.effect.szo}}</td>

                  <td class="border-right">{{(selectedReport$ | async)?.equipment_network.lep_6_20}}</td>
                  <td class="border-right">{{(selectedReport$ | async)?.equipment_network.tp_6_20}}</td>

                  <td class="border-right">{{(selectedReport$ | async)?.equipment_network.effect.population}}</td>
                  <td class="border-right">{{(selectedReport$ | async)?.equipment_network.effect.power}}</td>
                  <td class="border-right">{{(selectedReport$ | async)?.equipment_network.effect.szo}}</td>

                  <td class="total border-right">{{(selectedReport$ | async)?.total?.tp_6_20}}</td>
                  <td class="total border-right">{{(selectedReport$ | async)?.total?.population}}</td>
                  <td class="total border-right">{{(selectedReport$ | async)?.total?.power}}</td>
                  <td class="total">{{(selectedReport$ | async)?.total?.szo}}</td>
                </tr>
              </table>
            </div>
          </div>
        </div>
      </div>

      <div class="row mt-5">
        <div class="col-12">
          <div class="row">
            <div class="col-auto">
              <span class="row-caption">Нарушения</span>
            </div>
          </div>

          <div class="row">
            <div class="col-12">
              <table class="operative-situation-reports w-100 h-100 mat-elevation-z1">
                <tr class="border-bottom">
                  <th rowspan="2" scope="colgroup" class="top border-right">Всего 6 кВ и выше</th>
                  <th colspan="4" scope="colgroup" class="top border-right">Основная сеть 35 кВ и выше</th>
                  <th rowspan="2" scope="colgroup" class="top border-right">ЛЭП<br> р/с</th>
                  <th rowspan="2" scope="colgroup" class="top border-right">ТН с погаш.</th>
                  <th colspan="3" scope="colgroup" class="top border-right">Сеть 0,4 кВ</th>
                  <th colspan="2" scope="colgroup" class="top">Население, чел</th>
                </tr>
                <tr>
                  <th scope="col" class="font-weight-normal border-right">УАПВ</th>
                  <th scope="col" class="font-weight-normal border-right">НАПВ</th>
                  <th scope="col" class="font-weight-normal border-right">С обесточ.</th>
                  <th scope="col" class="font-weight-normal border-right">Итого</th>

                  <th scope="col" class="font-weight-normal border-right">С 6:00</th>
                  <th scope="col" class="font-weight-normal border-right">Откл. на срез</th>
                  <th scope="col" class="font-weight-normal border-right">Более 3 часов</th>

                  <th scope="col" class="font-weight-normal border-right">По сети 0,4 кВ на срез</th>
                  <th scope="col" class="font-weight-normal">По сети 0,4 кВ (более 3 часов)</th>
                </tr>
                <tr class="content">
                  <td class="p-3 border-right">{{(selectedReport$ | async)?.violations.total_6}}</td>
                  <td class="p-3 border-right">{{(selectedReport$ | async)?.violations.uapv_35}}</td>
                  <td class="p-3 border-right">{{(selectedReport$ | async)?.violations.napv_35}}</td>
                  <td class="p-3 border-right">{{(selectedReport$ | async)?.violations.power_off_35}}</td>
                  <td class="p-3 border-right">{{(selectedReport$ | async)?.violations.uapv_35 + (selectedReport$ | async)?.violations.napv_35}}</td>

                  <td class="p-3 border-right">{{(selectedReport$ | async)?.violations.lep_rs}}</td>
                  <td class="p-3 border-right">{{(selectedReport$ | async)?.violations.tn_cancel}}</td>
                  <td class="p-3 border-right">{{(selectedReport$ | async)?.violations.from_6_04}}</td>
                  <td class="p-3 border-right">{{(selectedReport$ | async)?.violations.power_off_04}}</td>
                  <td class="p-3 border-right">{{(selectedReport$ | async)?.violations.greater_3_04}}</td>
                  <td class="p-3 border-right">{{(selectedReport$ | async)?.violations.population_srez_04}}</td>
                  <td class="p-3">{{(selectedReport$ | async)?.violations.population_greater_3_04}}</td>
                </tr>
              </table>
            </div>
          </div>
        </div>
      </div>

      <div class="row mt-5">

        <div class="col-12">

          <div class="row">
            <div class="col-auto pr-4 h-100">
              <span class="row-caption">Задействованные ресурсы</span>

              <div class="d-flex flex-column">
                <div class="d-flex flex-row justify-content-between pb-3">
                  <app-indicator
                    class="mr-3"
                    [value]="(selectedReport$ | async)?.resources?.rise"
                    [title]="'Задействовано РИСЭ, шт'">
                  </app-indicator>
                  <app-indicator
                    class="mr-3"
                    [value]="(selectedReport$ | async)?.resources?.riseSumPower"
                    [title]="'Суммарная мощность, кВт'">
                  </app-indicator>
                  <app-indicator
                    [value]="(selectedReport$ | async)?.resources?.risePeople"
                    [title]="'Запитано от РИСЭ, человек'">
                  </app-indicator>
                </div>
                <div class="d-flex flex-row justify-content-between align-items-stretch">
                  <app-indicator
                    [value]="(selectedReport$ | async)?.resources.brigades"
                    [title]="'Задействовано бригад, шт'">
                  </app-indicator>
                  <app-indicator
                    [value]="(selectedReport$ | async)?.resources.people"
                    [title]="'Задействовано человек'">
                  </app-indicator>
                  <app-indicator
                    [value]="(selectedReport$ | async)?.resources.technics"
                    [title]="'Единиц техники, шт'">
                  </app-indicator>
                </div>
              </div>

            </div>
            <div class="col">
              <span class="row-caption">Погодные условия</span>
              <app-weather-summary
                [weatherSummary]="(selectedReportWeatherSummary | async)"
                [showMode]="true">
              </app-weather-summary>
            </div>
          </div>

        </div>
      </div>
    </div>
  </div>

</div>
