<div class="container-fluid h-100 pl-0 pr-0">
  <div class="row h-100" *ngIf="!(selectedReport$ | async)">
    <div class="no-report-placeholder col-12">
      Отчет об оперативной обстановке отсутствует
    </div>
  </div>

  <div class="row pt-4 pb-4" *ngIf="selectedReport$ | async">
    <div class="col-12">
      <!-- Start: Оборудование 35-150 кВ, задействованные ресурсы, потребление и режим работы -->
      <div class="row">
        <!-- Start: Оборудование 35-150 кВ -->
        <div class="col-6">
          <!-- Start: Заголвок -->
          <div class="row">
            <div class="col-auto">
              <span class="row-caption">Оборудование 35-150 кВ</span>
            </div>
          </div>
          <!-- End: Заголвок -->

          <!-- Start: Панель с данными -->
          <div class="row">
            <div class="col-12">
              <div class="panel indicator-panel flex-column mat-elevation-z1">
                <!-- Start: Отключенное оборудование -->
                <div class="indicator-group">
                  <div class="caption">
                    <span class="title">Отключенное оборудование</span>
                  </div>
                  <div class="indicators">
                    <div class="indicators-with-header with-margin">
                      <div class="header">По сети 35-150 кВ</div>
                      <div class="body">
                        <div class="indicator">
                          <span class="title">ЛЭП 110-150 кВ, шт</span>
                          <span class="value">{{(selectedReport$ | async)?.equipment_35_150.lep_110_150}}</span>
                        </div>
                        <div class="indicator">
                          <span class="title">ЛЭП 35 кВ, шт</span>
                          <span class="value">{{(selectedReport$ | async)?.equipment_35_150.lep_35}}</span>
                        </div>
                        <div class="indicator">
                          <span class="title">ПС 110-150 кВ, шт</span>
                          <span class="value">{{(selectedReport$ | async)?.equipment_35_150.ps_110_150}}</span>
                        </div>
                        <div class="indicator">
                          <span class="title">ПС 35 кВ, шт</span>
                          <span class="value">{{(selectedReport$ | async)?.equipment_35_150.ps_35}}</span>
                        </div>
                      </div>
                    </div>

                    <div class="indicators-with-header">
                      <div class="header">Распред. сеть</div>
                      <div class="body">
                        <div class="indicator">
                          <span class="title">ЛЭП 6-20 кВ, шт</span>
                          <span class="value">{{(selectedReport$ | async)?.equipment_network.lep_6_20}}</span>
                        </div>
                        <div class="indicator">
                          <span class="title">ТП 6-20 кВ, шт</span>
                          <span class="value">{{(selectedReport$ | async)?.equipment_network.tp_6_20}}</span>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
                <!-- End: Отключенное оборудование -->

                <!-- Start: Последствия для потребителей -->
                <div class="indicator-group mt-4">
                  <div class="caption">
                    <span class="title">Последствия для потребителей</span>
                  </div>
                  <div class="indicators flex-column">
                    <div class="indicators-with-header">
                      <div class="header">По сети 35-150 кВ</div>
                      <div class="body">
                        <div class="indicator">
                          <span class="title">ТП 6-20 кВ, шт</span>
                          <span class="value">{{(selectedReport$ | async)?.equipment_35_150.effect.tp_6_20}}</span>
                        </div>
                        <div class="indicator">
                          <span class="title">Население, чел</span>
                          <span class="value">{{(selectedReport$ | async)?.equipment_35_150.effect.population}}</span>
                        </div>
                        <div class="indicator">
                          <span class="title">Нагрузка, МВт</span>
                          <span class="value">{{(selectedReport$ | async)?.equipment_35_150.effect.power}}</span>
                        </div>
                        <div class="indicator">
                          <span class="title">СЗО, шт</span>
                          <span class="value">{{(selectedReport$ | async)?.equipment_35_150.effect.szo}}</span>
                        </div>
                      </div>
                    </div>

                    <div class="indicators-with-header">
                      <div class="header">Распред. сеть</div>
                      <div class="body">
                        <div class="indicator empty">
                          <span class="title"></span>
                          <span class="value"></span>
                        </div>
                        <div class="indicator">
                          <span class="title">Население, чел</span>
                          <span class="value">{{(selectedReport$ | async)?.equipment_network.effect.population}}</span>
                        </div>
                        <div class="indicator">
                          <span class="title">Нагрузка, МВт</span>
                          <span class="value">{{(selectedReport$ | async)?.equipment_network.effect.power}}</span>
                        </div>
                        <div class="indicator">
                          <span class="title">СЗО, шт</span>
                          <span class="value">{{(selectedReport$ | async)?.equipment_network.effect.szo}}</span>
                        </div>
                      </div>
                    </div>

                    <div class="indicators-with-header">
                      <div class="header">Суммарно</div>
                      <div class="body">
                        <div class="indicator highlighted">
                          <span class="title">ТП 6-20 кВ, шт</span>
                          <span class="value">{{(selectedReport$ | async)?.total?.tp_6_20}}</span>
                        </div>
                        <div class="indicator highlighted">
                          <span class="title">Население, чел</span>
                          <span class="value">{{(selectedReport$ | async)?.total?.population}}</span>
                        </div>
                        <div class="indicator highlighted">
                          <span class="title highlighted">Нагрузка, МВт</span>
                          <span class="value">{{(selectedReport$ | async)?.total?.power}}</span>
                        </div>
                        <div class="indicator highlighted">
                          <span class="title">СЗО, шт</span>
                          <span class="value">{{(selectedReport$ | async)?.total?.szo}}</span>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
                <!-- End: Последствия для потребителей -->
              </div>
              <!--
              <table class="d-flex operative-situation-reports w-100 mat-elevation-z1">
                <tr>
                  <th colspan="4" scope="colgroup" class="top border-right" style="border-color: #E0E0E0 !important;">Отключенное оборудование по сети 35-150 кВ</th>
                  <th colspan="4" scope="colgroup" class="top border-right">Последствия для потребителей по сети 35-150 кВ</th>
                  <th colspan="2" scope="colgroup" class="top border-right">Распределительная сеть</th>
                  <th colspan="3" scope="colgroup" class="top border-right">Последствия для потребителей по распределительной сети</th>
                  <th colspan="4" scope="colgroup" class="top">Последствия для потребителей суммарно по основной и распределительной сети</th>
                </tr>
                <tr>
                  <th scope="col" class="font-weight-normal border-right">ЛЭП 110-150 кВ, шт</th>
                  <th scope="col" class="font-weight-normal border-right">ЛЭП 35 кВ, шт.</th>
                  <th scope="col" class="font-weight-normal border-right">ПС 110 -150 кВ, шт</th>
                  <th scope="col" class="font-weight-normal border-right">ПС 35 кВ, шт</th>

                  <th scope="col" class="font-weight-normal border-right">ТП 6-20 кВ, шт</th>
                  <th scope="col" class="font-weight-normal border-right">Население, чел</th>
                  <th scope="col" class="font-weight-normal border-right">Нагрузка, МВт</th>
                  <th scope="col" class="font-weight-normal border-right">СЗО, шт</th>

                  <th scope="col" class="font-weight-normal border-right">ЛЭП 6-20 кВ, шт</th>
                  <th scope="col" class="font-weight-normal border-right">ТП 6-20 кВ, шт</th>

                  <th scope="col" class="font-weight-normal border-right">Население, чел</th>
                  <th scope="col" class="font-weight-normal border-right">Нагрузка, МВт</th>
                  <th scope="col" class="font-weight-normal border-right">СЗО, шт</th>

                  <th scope="col" class="font-weight-normal border-right">ТП 6-20 кВ, шт</th>
                  <th scope="col" class="font-weight-normal border-right">Население, чел</th>
                  <th scope="col" class="font-weight-normal border-right">Нагрузка, МВт</th>
                  <th scope="col" class="font-weight-normal">СЗО, шт</th>
                </tr>
                <tr class="content">
                  <td class="border-right">{{(selectedReport$ | async)?.equipment_35_150.lep_110_150}}</td>
                  <td class="border-right">{{(selectedReport$ | async)?.equipment_35_150.lep_35}}</td>
                  <td class="border-right">{{(selectedReport$ | async)?.equipment_35_150.ps_110_150}}</td>
                  <td class="border-right">{{(selectedReport$ | async)?.equipment_35_150.ps_35}}</td>

                  <td class="border-right">{{(selectedReport$ | async)?.equipment_35_150.effect.tp_6_20}}</td>
                  <td class="border-right">{{(selectedReport$ | async)?.equipment_35_150.effect.population}}</td>
                  <td class="border-right">{{(selectedReport$ | async)?.equipment_35_150.effect.power}}</td>
                  <td class="border-right">{{(selectedReport$ | async)?.equipment_35_150.effect.szo}}</td>

                  <td class="border-right">{{(selectedReport$ | async)?.equipment_network.lep_6_20}}</td>
                  <td class="border-right">{{(selectedReport$ | async)?.equipment_network.tp_6_20}}</td>

                  <td class="border-right">{{(selectedReport$ | async)?.equipment_network.effect.population}}</td>
                  <td class="border-right">{{(selectedReport$ | async)?.equipment_network.effect.power}}</td>
                  <td class="border-right">{{(selectedReport$ | async)?.equipment_network.effect.szo}}</td>

                  <td class="total border-right">{{(selectedReport$ | async)?.total?.tp_6_20}}</td>
                  <td class="total border-right">{{(selectedReport$ | async)?.total?.population}}</td>
                  <td class="total border-right">{{(selectedReport$ | async)?.total?.power}}</td>
                  <td class="total">{{(selectedReport$ | async)?.total?.szo}}</td>
                </tr>
              </table>
              -->
            </div>
          </div>
          <!-- End: Панель с данными -->
        </div>
        <!-- End: Оборудование 35-150 кВ -->

        <!-- Start: Задействованные ресурсы -->
        <div class="col-auto d-flex flex-column">
          <span class="row-caption">Задействованные ресурсы</span>

          <div class="d-flex flex-column justify-content-between flex-grow-1">
            <div class="d-flex flex-row justify-content-between">
              <app-indicator
                class="mr-3"
                [value]="(selectedReport$ | async)?.resources?.rise"
                [title]="'Задействовано РИСЭ, шт'">
              </app-indicator>
              <app-indicator
                [value]="(selectedReport$ | async)?.resources?.riseSumPower"
                [title]="'Суммарная мощность, кВт'">
              </app-indicator>
            </div>
            <div class="d-flex flex-row justify-content-between align-items-stretch">
              <app-indicator
                class="mr-3"
                [value]="(selectedReport$ | async)?.resources?.risePeople"
                [title]="'Запитано от РИСЭ, человек'">
              </app-indicator>
              <app-indicator
                [value]="(selectedReport$ | async)?.resources.brigades"
                [title]="'Задействовано бригад, шт'">
              </app-indicator>
            </div>
            <div class="d-flex flex-row justify-content-between align-items-stretch">
              <app-indicator
                class="mr-3"
                [value]="(selectedReport$ | async)?.resources.people"
                [title]="'Задействовано человек'">
              </app-indicator>
              <app-indicator
                [value]="(selectedReport$ | async)?.resources.technics"
                [title]="'Единиц техники, шт'">
              </app-indicator>
            </div>
          </div>

        </div>
        <!-- End: Задействованные ресурсы -->

        <!-- Start: Потребление и режим работы -->
        <div class="col d-flex flex-column">
          <!-- Start: Потребление -->
          <div class="d-flex flex-column flex-grow-1">
            <!-- Start: Заголовок -->
            <div class="row">
              <div class="col-auto">
                <span class="row-caption">Потребление</span>
              </div>
            </div>
            <!-- End: Заголовок -->

            <!-- Start: Панель с данными -->
            <div class="row d-flex flex-column flex-grow-1">
              <div class="col-12">
                <div class="panel indicator-panel h-100 flex-column justify-content-center align-items-center flex-grow-1 mat-elevation-z1">
                  <div *ngIf="!inEditConsumptionMode">
                    <div class="value">{{(selectedReport$ | async)?.consumption ? (selectedReport$ | async)?.consumption : 0}}</div>
                    <div class="label">Максимум потребления за прошедшие сутки</div>
                    <button mat-stroked-button class="mt-3" color="primary" (click)="inEditConsumptionMode = !inEditConsumptionMode">Изменить</button>
                  </div>
                  <div *ngIf="inEditConsumptionMode"
                                [formGroup]="consumptionForm">
                    <mat-form-field appearance="fill" class="w-100">
                      <mat-label>Потребление</mat-label>
                      <input matInput type="number" min="0" formControlName="consumption">
                    </mat-form-field>
                  </div>
                </div>
              </div>
            </div>
            <!-- End: Панель с данными -->
          </div>
          <!-- End: Потребление -->

          <!-- Start: Режим работы -->
          <div class="d-flex flex-column flex-grow-1 mt-3">
            <!-- Start: Заголовок -->
            <div class="row">
              <div class="col-auto">
                <span class="row-caption">Режим работы</span>
              </div>
            </div>
            <!-- End: Заголовок -->

            <!-- Start: Панель с данными -->
            <div class="row d-flex flex-column flex-grow-1">
              <div class="col-12">
                <div class="panel indicator-panel h-100 flex-column justify-content-center align-items-center flex-grow-1 mat-elevation-z1">
                  <div class="value">{{(selectedReport$ | async)?.weather.orr ? 'ОРР' : (selectedReport$ | async)?.weather.rpg ? 'РПГ' : 'Нет'}}</div>
                  <div class="label">{{(selectedReport$ | async)?.weather.orr ? 'Особый режим работы' : (selectedReport$ | async)?.weather.rpg ? 'Режим повышенной готовности' : 'ОРР / РПГ'}}</div>
                </div>
              </div>
            </div>
            <!-- End: Панель с данными -->
          </div>
          <!-- End: Режим работы -->
        </div>
        <!-- End: Потребление и режим работы -->
      </div>
      <!-- End: Оборудование 35-150 кВ, задействованные ресурсы, потребление и режим работы -->

      <!-- Start: Нарушения и погодные условия -->
      <div class="row mt-4">
        <!-- Start: Нарушения -->
        <div class="col-6">
          <!-- Start: Заголовок -->
          <div class="row">
            <div class="col-12">
              <span class="row-caption">Нарушения</span>
            </div>
          </div>
          <!-- End: Заголовок -->

          <!-- Start: Панель с данными -->
          <div class="row">
            <div class="col-12">
              <div class="panel indicator-panel mat-elevation-z1 flex-column">
                <div class="indicator-group">
                  <div class="caption">
                    <span class="title">Основная сеть 35 кВ и выше</span>
                  </div>
                  <div class="indicators">
                    <div class="indicators-without-header">
                      <div class="indicator border-right-0">
                        <span class="title">Всего 6 кВ и выше</span>
                        <span class="value">{{(selectedReport$ | async)?.violations.total_6}}</span>
                      </div>
                    </div>
                    <div class="indicators-with-header">
                      <div class="header">По сети 35-150 кВ</div>
                      <div class="body">
                        <div class="indicator">
                          <span class="title">УАПВ</span>
                          <span class="value">{{(selectedReport$ | async)?.violations.uapv_35}}</span>
                        </div>
                        <div class="indicator">
                          <span class="title">НАПВ</span>
                          <span class="value">{{(selectedReport$ | async)?.violations.napv_35}}</span>
                        </div>
                        <div class="indicator">
                          <span class="title">С обесточ.</span>
                          <span class="value">{{(selectedReport$ | async)?.violations.power_off_35}}</span>
                        </div>
                        <div class="indicator">
                          <span class="title">Итого</span>
                          <span
                            class="value">{{(selectedReport$ | async)?.violations.uapv_35 + (selectedReport$ | async)?.violations.napv_35}}</span>
                        </div>
                      </div>
                    </div>
                    <div class="indicators-without-header">
                      <div class="indicator border-left-0">
                        <span class="title">ЛЭП р/с</span>
                        <span class="value">{{(selectedReport$ | async)?.violations.lep_rs}}</span>
                      </div>
                      <div class="indicator border-left-0">
                        <span class="title">ТН с погаш.</span>
                        <span class="value">{{(selectedReport$ | async)?.violations.tn_cancel}}</span>
                      </div>
                    </div>
                  </div>
                </div>

                <div class="indicator-group mt-4">
                  <div class="caption">
                    <span class="title">Сеть 0,4 кВ</span>
                  </div>
                  <div class="indicators">
                    <div class="indicators-without-header">
                      <!--<div class="header">По сети 35-150 кВ</div>-->
                      <div class="body">
                        <div class="indicator no-header border-right-0">
                          <span class="title">С 6:00</span>
                          <span class="value">{{(selectedReport$ | async)?.violations.from_6_04}}</span>
                        </div>
                        <div class="indicator no-header border-right-0">
                          <span class="title">Откл. на срез</span>
                          <span class="value">{{(selectedReport$ | async)?.violations.power_off_04}}</span>
                        </div>
                        <div class="indicator no-header border-right-0">
                          <span class="title">Более 3 часов</span>
                          <span class="value">{{(selectedReport$ | async)?.violations.greater_3_04}}</span>
                        </div>
                      </div>
                    </div>
                    <div class="indicators-with-header">
                      <div class="header">Население, чел.</div>
                      <div class="body">
                        <div class="indicator">
                          <span class="title">По сети 0,4 кВ на срез</span>
                          <span class="value">{{(selectedReport$ | async)?.violations.population_srez_04}}</span>
                        </div>
                        <div class="indicator">
                          <span class="title">По сети 0,4 кВ (более 3 часов)</span>
                          <span class="value">{{(selectedReport$ | async)?.violations.population_greater_3_04}}</span>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>

              <!--
              <table class="operative-situation-reports w-100 h-100 mat-elevation-z1">
                <tr class="border-bottom">
                  <th rowspan="2" scope="colgroup" class="top border-right">Всего 6 кВ и выше</th>
                  <th colspan="4" scope="colgroup" class="top border-right">Основная сеть 35 кВ и выше</th>
                  <th rowspan="2" scope="colgroup" class="top border-right">ЛЭП<br> р/с</th>
                  <th rowspan="2" scope="colgroup" class="top border-right">ТН с погаш.</th>
                  <th colspan="3" scope="colgroup" class="top border-right">Сеть 0,4 кВ</th>
                  <th colspan="2" scope="colgroup" class="top">Население, чел</th>
                </tr>
                <tr>
                  <th scope="col" class="font-weight-normal border-right">УАПВ</th>
                  <th scope="col" class="font-weight-normal border-right">НАПВ</th>
                  <th scope="col" class="font-weight-normal border-right">С обесточ.</th>
                  <th scope="col" class="font-weight-normal border-right">Итого</th>

                  <th scope="col" class="font-weight-normal border-right">С 6:00</th>
                  <th scope="col" class="font-weight-normal border-right">Откл. на срез</th>
                  <th scope="col" class="font-weight-normal border-right">Более 3 часов</th>

                  <th scope="col" class="font-weight-normal border-right">По сети 0,4 кВ на срез</th>
                  <th scope="col" class="font-weight-normal">По сети 0,4 кВ (более 3 часов)</th>
                </tr>
                <tr class="content">
                  <td class="p-3 border-right">{{(selectedReport$ | async)?.violations.total_6}}</td>
                  <td class="p-3 border-right">{{(selectedReport$ | async)?.violations.uapv_35}}</td>
                  <td class="p-3 border-right">{{(selectedReport$ | async)?.violations.napv_35}}</td>
                  <td class="p-3 border-right">{{(selectedReport$ | async)?.violations.power_off_35}}</td>
                  <td
                    class="p-3 border-right">{{(selectedReport$ | async)?.violations.uapv_35 + (selectedReport$ | async)?.violations.napv_35}}</td>

                  <td class="p-3 border-right">{{(selectedReport$ | async)?.violations.lep_rs}}</td>
                  <td class="p-3 border-right">{{(selectedReport$ | async)?.violations.tn_cancel}}</td>
                  <td class="p-3 border-right">{{(selectedReport$ | async)?.violations.from_6_04}}</td>
                  <td class="p-3 border-right">{{(selectedReport$ | async)?.violations.power_off_04}}</td>
                  <td class="p-3 border-right">{{(selectedReport$ | async)?.violations.greater_3_04}}</td>
                  <td class="p-3 border-right">{{(selectedReport$ | async)?.violations.population_srez_04}}</td>
                  <td class="p-3">{{(selectedReport$ | async)?.violations.population_greater_3_04}}</td>
                </tr>
              </table>
              -->
            </div>
          </div>
          <!-- End: Панель с данными -->
        </div>
        <!-- End: Нарушения -->

        <!-- Start: Погодные условия -->
        <div class="col-6 d-flex flex-column">
          <span class="row-caption">Погодные условия</span>
          <app-weather-summary
            class="d-flex flex-column flex-grow-1"
            [weatherSummary]="(selectedReport$ | async)?.weatherSummary"
            [showMode]="false">
          </app-weather-summary>
        </div>
        <!-- End: Погодные условия -->
      </div>
      <!-- End: Нарушения и погодные условия -->
    </div>

  </div>

</div>
